<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 内部类 · Joe's blog</title><meta name="description" content="内部类 - Joe Ljt"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="http://p5zd0id9p.bkt.clouddn.com/18-3-22/55865119.jpg"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="http://joeljt.top/atom.xml" title="Joe's blog"></head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">Joe's blog</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>NOW</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>LAST DAYS</p></a><ul class="shortcut-icons"><a href="https://github.com/JoeLjt" target="_blank"><div id="img" src="/images/github.svg" class="icon"></div></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title">内部类</h1><div class="post-info">Mar 22, 2018</div><div class="post-content"><p>匿名内部类了解一下？其实你每天都在用。</p>
<a id="more"></a>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>将一个类声明在另一个类的内部，则将这个类成为内部类。其与外部类互相访问规则如下：</p>
<ul>
<li>内部类可以访问外部类的一切成员，包括私有成员；</li>
<li>外部类若想访问内部类的成员，则必须声明内部类的实例对象。</li>
</ul>
<p>这个规则可以这么理解，外部类和内部类就像父母和孩子：不管孩子要什么，父母总是会满足；但孩子有独立意识后，父母想了解孩子，就必须先得到孩子的同意才可以。</p>
<p>虽说有了规则限制，但内部类又可以划分为普通内部类，静态内部类以及匿名内部类，因此在实际使用的时候，难免还是会有迷惑的地方。下面，用伪代码进行一下区别展示。</p>
<h2 id="普通内部类的调用"><a href="#普通内部类的调用" class="headerlink" title="普通内部类的调用"></a>普通内部类的调用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Outer</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> value = <span class="number">10</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Inner</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> value = <span class="number">20</span>;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">showValue</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">int</span> value = <span class="number">30</span>;</span><br><span class="line">            System.out.print(<span class="string">"this is funcValue -&gt; "</span> + value); <span class="comment">//30</span></span><br><span class="line">            System.out.print(<span class="string">"this is innerValue -&gt; "</span> + <span class="keyword">this</span>.value); <span class="comment">//20</span></span><br><span class="line">            System.out.print(<span class="string">"this is outerValue -&gt; "</span> + Outer.<span class="keyword">this</span>.value); <span class="comment">//10</span></span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] str)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 普通内部类，实例化内部类对象时，需要先实例化Outer类对象，然后用Outer类对象实例化Inner类对象</span></span><br><span class="line">        Outer.Inner inner = <span class="keyword">new</span> Outer().new Inner(); </span><br><span class="line">        inner.showValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="静态内部类的调用"><a href="#静态内部类的调用" class="headerlink" title="静态内部类的调用"></a>静态内部类的调用</h2><p>当一个类为内部成员时，其便可以像其他内部属性、方法一样，被各种成员修饰符所修饰。</p>
<p>静态内部类有两个需要注意的点：</p>
<ul>
<li>因为被声明为静态，所以只能访问外部类中同样的静态属性、方法等；</li>
<li>当一个类为静态内部类时，外部类对其的调用方式也会发生不同</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Outer</span></span>&#123;</span><br><span class="line">  	 <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> outStaticValue = <span class="number">10</span>;</span><br><span class="line">  	 <span class="keyword">private</span> <span class="keyword">int</span> outValue = <span class="number">11</span>;</span><br><span class="line">     <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Inner</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">showValue</span><span class="params">()</span></span>&#123;</span><br><span class="line">            System.out.print(<span class="string">"this is static Inner "</span> + outStaticValue); <span class="comment">// 可以访问</span></span><br><span class="line">            System.out.print(<span class="string">"this is static Inner "</span> + outValue); <span class="comment">// 编译不通过</span></span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] str)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 静态内部类，实例化静态内部类对象时，直接通过Outer.Inner获取内部类即可</span></span><br><span class="line">        Outer.Inner inner = <span class="keyword">new</span> Outer.Inner(); </span><br><span class="line">        inner.showValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="匿名内部类的调用"><a href="#匿名内部类的调用" class="headerlink" title="匿名内部类的调用"></a>匿名内部类的调用</h2><p>我们都熟悉匿名对象的用法，最简单的如 new Object().toString()，便是匿名对象的基本使用了。</p>
<p>同理，匿名内部类也是类似的。</p>
<p>但是也有不同，那就是声明匿名内部类，要求类必须继承一个抽象类或者实现一个接口。</p>
<p>下面看一下正常逻辑实现，以及匿名内部类实现的代码示例。</p>
<ul>
<li>正常逻辑实现调用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ParentClass</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Outer</span></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Inner</span> <span class="keyword">extends</span> <span class="title">ParentClass</span></span>&#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">new</span> Inner().show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] str)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 正常逻辑实现调用</span></span><br><span class="line">        <span class="keyword">new</span> Outer().func();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>匿名内部类实现方式<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ParentClass</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Outer</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">new</span> ParentClass()&#123;</span><br><span class="line">            <span class="meta">@override</span></span><br><span class="line">            <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">		&#125;.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Outer().func();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>其实匿名内部类很简单，说到底就是new Parent(){实现父类或者接口的抽象方法}</p>
<p>是不是觉得很眼熟？没错，我们基本上每天都在用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mButton.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;&#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<p>View.OnClickListener是一个抽象接口，我们这种实现方式，其实就是匿名内部类的实现。</p>
<h2 id="定义在方法中的内部类"><a href="#定义在方法中的内部类" class="headerlink" title="定义在方法中的内部类"></a>定义在方法中的内部类</h2><p>除了以上三种常见的形态，内部类还可以声明在局部，比如方法体内部：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Outer</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">InnerFunc</span>()</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">void</span> <span class="title">showMsg</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">      	<span class="keyword">new</span> InnerFunc().showMsg();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Outer().show(); <span class="comment">// 这样就可以调用定义在方法内部的类了</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是这种形式在日常开发中使用并不多，至少我没有用过。说到这里，感觉这个有点类似于python的在方法中声明方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outerFunc</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">innerFunc</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"this is innerFunc"</span></span><br><span class="line">    <span class="keyword">return</span> innerFunc</span><br></pre></td></tr></table></figure>
<p>内部类总结大概就要结束啦，以后想到再补充。</p>
<p>以上。</p>
</div></article></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'JoeLjt';
var disqus_identifier = '2018/03/22/内部类/';
var disqus_title = '内部类';
var disqus_url = 'http://joeljt.top/2018/03/22/内部类/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//JoeLjt.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a href="/2018/03/09/java中多态的具体应用/" class="next">NEXT</a></div><div class="copyright"><p>© 2018 <a href="http://joeljt.top">Joe Ljt</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"JoeLjt",'auto');ga('send','pageview');</script></body></html>